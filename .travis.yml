# Ngôn ngữ sử dụng
language: node_js

# Các phiên bản Node.js cần kiểm tra
node_js:
  - 16

# Chỉ định nhánh để chạy pipeline
branches:
  only:
    - src
services:
  - docker
# Cài đặt các dependencies trước khi chạy các lệnh test
#before_install:


# Build và push image Docker sau khi test thành công
after_success:
  echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
  - docker build -t udagram-frontend ./udagram-frontend
  - docker build -t udagram-api-feed ./udagram-api-feed
  - docker build -t udagram-api-user ./udagram-api-user
  - docker build -t linhhm9/udagram-reverseproxy ./udagram-reverseproxy
  - docker push udagram-frontend
  - docker push udagram-api-feed
  - docker push udagram-api-user
  - docker push linhhm9/udagram-reverseproxy